============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\Jonandrop\IdeaProjects\LangPlug\api_venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\Jonandrop\IdeaProjects\LangPlug\Backend
configfile: pytest.ini
testpaths: tests
plugins: anyio-3.7.1, asyncio-1.1.0, cov-7.0.0, timeout-2.4.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
timeout: 30.0s
timeout method: thread
timeout func_only: False
collecting ... collected 385 items / 12 skipped

tests/api/test_auth_contract.py::TestAuthContract::test_register_endpoint_contract PASSED [  0%]
tests/api/test_auth_contract.py::TestAuthContract::test_register_validation_contract PASSED [  0%]
tests/api/test_auth_contract.py::TestAuthContract::test_login_endpoint_contract PASSED [  0%]
tests/api/test_auth_contract.py::TestAuthContract::test_login_invalid_credentials_contract PASSED [  1%]
tests/api/test_auth_contract.py::TestAuthContract::test_logout_endpoint_contract PASSED [  1%]
tests/api/test_auth_contract.py::TestAuthContract::test_me_endpoint_contract PASSED [  1%]
tests/api/test_auth_contract.py::TestAuthContract::test_me_endpoint_unauthorized_contract PASSED [  1%]
tests/api/test_auth_contract.py::TestAuthContract::test_auth_endpoints_content_type_contract[/api/auth/register-post] PASSED [  2%]
tests/api/test_auth_contract.py::TestAuthContract::test_auth_endpoints_content_type_contract[/api/auth/login-post] PASSED [  2%]
tests/api/test_auth_contract.py::TestAuthContract::test_auth_endpoints_content_type_contract[/api/auth/logout-post] PASSED [  2%]
tests/api/test_auth_contract.py::TestAuthContract::test_auth_endpoints_content_type_contract[/api/auth/me-get] PASSED [  2%]
tests/api/test_auth_endpoints.py::test_register_endpoint[asyncio] FAILED [  3%]
tests/api/test_auth_endpoints.py::test_register_endpoint[trio] FAILED    [  3%]
tests/api/test_auth_endpoints.py::test_login_endpoint[asyncio] FAILED    [  3%]
tests/api/test_auth_endpoints.py::test_login_endpoint[trio] FAILED       [  3%]
tests/api/test_auth_endpoints.py::test_register_duplicate_username[asyncio] FAILED [  4%]

================================== FAILURES ===================================
_______________________ test_register_endpoint[asyncio] _______________________
tests\api\test_auth_endpoints.py:77: in test_register_endpoint
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr setup ----------------------------
{"timestamp": "2025-09-14 11:01:43", "level": "WARNING", "logger": "database.database_manager", "message": "Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}", "module": "database_manager", "function": "_verify_schema", "line": "328"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "database.database_manager", "message": "Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmpilox65uq.db", "module": "database_manager", "function": "_create_database", "line": "129"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "database.database_manager", "message": "Default admin user created with username 'admin'", "module": "database_manager", "function": "_create_default_admin_user", "line": "304"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "database.database_manager", "message": "Database schema created successfully", "module": "database_manager", "function": "_create_database", "line": "146"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "core.middleware", "message": "Middleware configured successfully", "module": "middleware", "function": "setup_middleware", "line": "194"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "core.app", "message": "Debug routes enabled (debug mode)", "module": "app", "function": "create_app", "line": "88"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "core.app", "message": "FastAPI application created and configured", "module": "app", "function": "create_app", "line": "92"}
----------------------------- Captured log setup ------------------------------
WARNING  database.database_manager:database_manager.py:328 Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}
INFO     database.database_manager:database_manager.py:129 Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmpilox65uq.db
INFO     database.database_manager:database_manager.py:304 Default admin user created with username 'admin'
INFO     database.database_manager:database_manager.py:146 Database schema created successfully
INFO     core.middleware:middleware.py:194 Middleware configured successfully
INFO     core.app:app.py:88 Debug routes enabled (debug mode)
INFO     core.app:app.py:92 FastAPI application created and configured
---------------------------- Captured stderr call -----------------------------
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
------------------------------ Captured log call ------------------------------
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"
________________________ test_register_endpoint[trio] _________________________
tests\api\test_auth_endpoints.py:77: in test_register_endpoint
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr setup ----------------------------
{"timestamp": "2025-09-14 11:01:43", "level": "WARNING", "logger": "database.database_manager", "message": "Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}", "module": "database_manager", "function": "_verify_schema", "line": "328"}
{"timestamp": "2025-09-14 11:01:43", "level": "INFO", "logger": "database.database_manager", "message": "Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmpg6u_wgk7.db", "module": "database_manager", "function": "_create_database", "line": "129"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Default admin user created with username 'admin'", "module": "database_manager", "function": "_create_default_admin_user", "line": "304"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Database schema created successfully", "module": "database_manager", "function": "_create_database", "line": "146"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.middleware", "message": "Middleware configured successfully", "module": "middleware", "function": "setup_middleware", "line": "194"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "Debug routes enabled (debug mode)", "module": "app", "function": "create_app", "line": "88"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "FastAPI application created and configured", "module": "app", "function": "create_app", "line": "92"}
----------------------------- Captured log setup ------------------------------
WARNING  database.database_manager:database_manager.py:328 Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}
INFO     database.database_manager:database_manager.py:129 Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmpg6u_wgk7.db
INFO     database.database_manager:database_manager.py:304 Default admin user created with username 'admin'
INFO     database.database_manager:database_manager.py:146 Database schema created successfully
INFO     core.middleware:middleware.py:194 Middleware configured successfully
INFO     core.app:app.py:88 Debug routes enabled (debug mode)
INFO     core.app:app.py:92 FastAPI application created and configured
---------------------------- Captured stderr call -----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
------------------------------ Captured log call ------------------------------
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"
________________________ test_login_endpoint[asyncio] _________________________
tests\api\test_auth_endpoints.py:90: in test_login_endpoint
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr setup ----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "WARNING", "logger": "database.database_manager", "message": "Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}", "module": "database_manager", "function": "_verify_schema", "line": "328"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmp1ksydmxw.db", "module": "database_manager", "function": "_create_database", "line": "129"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Default admin user created with username 'admin'", "module": "database_manager", "function": "_create_default_admin_user", "line": "304"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Database schema created successfully", "module": "database_manager", "function": "_create_database", "line": "146"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.middleware", "message": "Middleware configured successfully", "module": "middleware", "function": "setup_middleware", "line": "194"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "Debug routes enabled (debug mode)", "module": "app", "function": "create_app", "line": "88"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "FastAPI application created and configured", "module": "app", "function": "create_app", "line": "92"}
----------------------------- Captured log setup ------------------------------
WARNING  database.database_manager:database_manager.py:328 Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}
INFO     database.database_manager:database_manager.py:129 Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmp1ksydmxw.db
INFO     database.database_manager:database_manager.py:304 Default admin user created with username 'admin'
INFO     database.database_manager:database_manager.py:146 Database schema created successfully
INFO     core.middleware:middleware.py:194 Middleware configured successfully
INFO     core.app:app.py:88 Debug routes enabled (debug mode)
INFO     core.app:app.py:92 FastAPI application created and configured
---------------------------- Captured stderr call -----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/login "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
------------------------------ Captured log call ------------------------------
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 404 Not Found"
__________________________ test_login_endpoint[trio] __________________________
tests\api\test_auth_endpoints.py:90: in test_login_endpoint
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr setup ----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "WARNING", "logger": "database.database_manager", "message": "Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}", "module": "database_manager", "function": "_verify_schema", "line": "328"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmp5ofjpbtn.db", "module": "database_manager", "function": "_create_database", "line": "129"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Default admin user created with username 'admin'", "module": "database_manager", "function": "_create_default_admin_user", "line": "304"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Database schema created successfully", "module": "database_manager", "function": "_create_database", "line": "146"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.middleware", "message": "Middleware configured successfully", "module": "middleware", "function": "setup_middleware", "line": "194"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "Debug routes enabled (debug mode)", "module": "app", "function": "create_app", "line": "88"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "FastAPI application created and configured", "module": "app", "function": "create_app", "line": "92"}
----------------------------- Captured log setup ------------------------------
WARNING  database.database_manager:database_manager.py:328 Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}
INFO     database.database_manager:database_manager.py:129 Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmp5ofjpbtn.db
INFO     database.database_manager:database_manager.py:304 Default admin user created with username 'admin'
INFO     database.database_manager:database_manager.py:146 Database schema created successfully
INFO     core.middleware:middleware.py:194 Middleware configured successfully
INFO     core.app:app.py:88 Debug routes enabled (debug mode)
INFO     core.app:app.py:92 FastAPI application created and configured
---------------------------- Captured stderr call -----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/login "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
------------------------------ Captured log call ------------------------------
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 404 Not Found"
__________________ test_register_duplicate_username[asyncio] __________________
tests\api\test_auth_endpoints.py:100: in test_register_duplicate_username
    assert r1.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stderr setup ----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "WARNING", "logger": "database.database_manager", "message": "Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}", "module": "database_manager", "function": "_verify_schema", "line": "328"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmp0f806b23.db", "module": "database_manager", "function": "_create_database", "line": "129"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Default admin user created with username 'admin'", "module": "database_manager", "function": "_create_default_admin_user", "line": "304"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "database.database_manager", "message": "Database schema created successfully", "module": "database_manager", "function": "_create_database", "line": "146"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.middleware", "message": "Middleware configured successfully", "module": "middleware", "function": "setup_middleware", "line": "194"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "Debug routes enabled (debug mode)", "module": "app", "function": "create_app", "line": "88"}
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "core.app", "message": "FastAPI application created and configured", "module": "app", "function": "create_app", "line": "92"}
----------------------------- Captured log setup ------------------------------
WARNING  database.database_manager:database_manager.py:328 Missing tables: {'processing_sessions', 'session_word_discoveries', 'vocabulary', 'users', 'user_sessions', 'word_categories', 'unknown_words', 'word_category_associations', 'user_learning_progress'}
INFO     database.database_manager:database_manager.py:129 Creating new database at C:\Users\Jonandrop\AppData\Local\Temp\tmp0f806b23.db
INFO     database.database_manager:database_manager.py:304 Default admin user created with username 'admin'
INFO     database.database_manager:database_manager.py:146 Database schema created successfully
INFO     core.middleware:middleware.py:194 Middleware configured successfully
INFO     core.app:app.py:88 Debug routes enabled (debug mode)
INFO     core.app:app.py:92 FastAPI application created and configured
---------------------------- Captured stderr call -----------------------------
{"timestamp": "2025-09-14 11:01:44", "level": "INFO", "logger": "httpx", "message": "HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"", "module": "_client", "function": "_send_single_request", "line": "1773"}
------------------------------ Captured log call ------------------------------
INFO     httpx:_client.py:1773 HTTP Request: POST http://testserver/auth/register "HTTP/1.1 404 Not Found"
=========================== short test summary info ===========================
FAILED tests/api/test_auth_endpoints.py::test_register_endpoint[asyncio] - assert 404 == 200
 +  where 404 = <Response [404 Not Found]>.status_code
FAILED tests/api/test_auth_endpoints.py::test_register_endpoint[trio] - assert 404 == 200
 +  where 404 = <Response [404 Not Found]>.status_code
FAILED tests/api/test_auth_endpoints.py::test_login_endpoint[asyncio] - assert 404 == 200
 +  where 404 = <Response [404 Not Found]>.status_code
FAILED tests/api/test_auth_endpoints.py::test_login_endpoint[trio] - assert 404 == 200
 +  where 404 = <Response [404 Not Found]>.status_code
FAILED tests/api/test_auth_endpoints.py::test_register_duplicate_username[asyncio] - assert 404 == 200
 +  where 404 = <Response [404 Not Found]>.status_code
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 5 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
================== 5 failed, 11 passed, 12 skipped in 11.00s ==================
